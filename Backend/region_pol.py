from shapely.geometry import Polygon

# 1) Заранее объявляем полигоны по вашим координатам:
REGION_POLYGONS = {
    "Республика Адыгея": Polygon([
        (39.856293, 45.000000),(39.629163, 44.939431),(39.664440, 45.017770),
        (39.500832, 45.041660),(39.639159, 44.868881),(39.471660, 44.792221),
        (38.671378, 44.961379),(39.309427, 44.995269),(39.639428, 45.191927),(40.419438, 44.997767),
        (40.752778, 44.470539),(40.616098, 44.471931),(40.550539, 44.729988),
        (40.388887, 44.727489),(40.439427, 44.292770),(40.458318, 43.969990),
        (40.308039, 43.755550),(39.720267, 43.942489),(39.727209, 44.182208),
        (39.960267, 44.064442),(40.080547, 44.235271),(39.791657, 44.357498),
        (40.026375, 44.729160),(39.878036, 45.007220),(39.856293, 45.000000),
    ]),
    "Республика Калмыкия": Polygon([
        (43.731773, 47.476555),
        (43.629433, 47.559151),
        (43.705826, 47.684432),
        (44.065818, 47.910811),
        (44.389152, 47.868317),
        (44.466375, 48.040832),
        (44.323043, 48.059988),
        (44.309432, 48.259992),
        (44.535818, 48.206380),
        (44.549711, 48.058324),
        (44.800534, 48.052487),
        (44.956653, 48.211933),
        (45.713595, 48.037495),
        (45.829158, 47.723035),
        (46.296649, 47.436643),
        (46.680811, 47.632480),
        (46.830538, 47.576092),
        (46.515543, 47.391926),
        (46.796381, 46.996381),
        (47.227762, 46.740819),
        (46.913310, 46.555258),
        (46.961931, 46.428594),
        (46.660266, 46.428039),
        (46.478320, 46.275550),
        (46.866647, 46.248046),
        (46.833598, 46.072762),
        (47.166376, 46.113319),
        (46.889148, 45.578332),
        (47.359706, 45.689423),
        (47.578687, 45.402279),
        (47.456607, 45.371530),
        (47.309550, 45.176058),
        (47.154331, 44.796115),
        (46.910484, 44.743602),
        (46.439709, 44.936107),
        (45.706075, 44.975818),
        (45.538877, 45.179438),
        (44.219985, 45.603044),
        (43.891372, 45.941093),
        (42.922768, 46.242210),
        (42.517213, 45.989426),
        (42.318888, 45.969437),
        (42.333605, 46.127762),
        (42.176104, 46.104156),
        (42.104442, 45.926385),
        (41.712787, 45.995973),
        (41.646663, 46.173325),
        (41.963054, 46.302216),
        (42.210543, 46.314438),
        (42.035274, 46.555550),
        (42.718448, 46.369061),
        (42.933871, 46.438599),
        (43.361384, 46.170830),
        (43.619157, 46.186103),
        (43.771661, 46.409423),
        (43.967485, 46.338326),
        (43.812204, 46.584716),
        (44.260545, 46.896102),
        (44.333878, 47.481657),
        (44.119431, 47.542760),
        (43.936646, 47.265546),
        (43.789986, 47.286939),
        (43.741380, 47.469143),
        (43.731773, 47.476555),
    ]),
    "Краснодарский край": Polygon([
        (46.871048, 38.673985), (46.821939, 38.911377), (46.588037, 38.860551),
        (46.618318, 39.174165), (46.770547, 39.232758), (46.807771, 39.433867),
        (46.772073, 40.053114), (46.723041, 40.135816), (46.550822, 40.041380),
        (46.530543, 40.213049), (46.348880, 40.231100), (46.231662, 40.756384),
        (46.299167, 40.995534), (46.133884, 40.984991), (45.877484, 41.266104),
        (45.688046, 41.171369), (45.697208, 40.858596), (45.526653, 40.838592),
        (45.217382, 41.026908), (45.248327, 41.289718), (44.988889, 41.463050),
        (44.969442, 41.657759), (44.698324, 41.412208), (44.492216, 41.729978),
        (44.368606, 41.594435), (44.244721, 41.712766), (43.987771, 41.439710),
        (44.120957, 40.855574), (43.981110, 40.958044), (43.920838, 40.771659),
        (43.533651, 40.698596), (43.566480, 40.103084), (43.398843, 39.947917),
        (44.281980, 38.779860), (44.413454, 38.207890), (44.723009, 37.830002),
        (44.705565, 37.457584), (45.001871, 37.213613), (45.189202, 36.599669),
        (45.319061, 36.995863), (45.299648, 36.801863), (45.402338, 36.763671),
        (45.302425, 36.624725), (45.442923, 36.850585), (45.375896, 37.530111),
        (45.659201, 37.604974), (45.747365, 37.824975), (46.012669, 37.948055),
        (46.050171, 38.112556), (45.997895, 38.146194), (46.264172, 38.289665),
        (46.412003, 37.904252), (46.700004, 37.704030), (46.631087, 37.975945),
        (46.654586, 38.576526), (46.721393, 38.394389), (46.875059, 38.498857),
        (46.871050, 38.673982), (45.007224, 39.878037), (44.729164, 40.026376),
        (44.357502, 39.791658), (44.235275, 40.080548), (44.064446, 39.960268),
        (44.182212, 39.727210), (43.942493, 39.720268), (43.755554, 40.308040),
        (43.969994, 40.458319), (44.292774, 40.439428), (44.727493, 40.388888),
        (44.729992, 40.550540), (44.471935, 40.616099), (44.470543, 40.752779),
        (44.997771, 40.419439), (45.191931, 39.639429), (44.995273, 39.309428),
        (44.961383, 38.671379), (44.792225, 39.471661), (44.868885, 39.639160),
        (45.041664, 39.500833), (45.017774, 39.664441), (44.939435, 39.629164),
        (45.000004, 39.856294)
    ]),
    "Астраханская область": Polygon([
        (45.000000, 48.295681),
        (45.190268, 48.486381),
        (45.375547, 48.463881),
        (45.244437, 48.557211),
        (45.619155, 48.594992),
        (46.014440, 48.867491),
        (46.308599, 48.840826),
        (46.616583, 48.670572),
        (46.491858, 48.443000),
        (47.113776, 48.265498),
        (47.091835, 48.115001),
        (47.207443, 48.074305),
        (47.017639, 47.999999),
        (47.174305, 47.760750),
        (47.376971, 47.676250),
        (47.408220, 47.815028),
        (48.052331, 47.762721),
        (48.380691, 47.433582),
        (48.607746, 47.414472),
        (49.005329, 46.767167),
        (48.800885, 46.684084),
        (48.581221, 46.773947),
        (48.480692, 46.657667),
        (49.220915, 46.292696),
        (49.045774, 46.364751),
        (49.008860, 46.134001),
        (48.864359, 46.143084),
        (48.813524, 46.064059),
        (48.713973, 45.914558),
        (48.701415, 45.613197),
        (48.613693, 45.717559),
        (48.737946, 45.800948),
        (48.547638, 45.956362),
        (48.448503, 45.851390),
        (48.517419, 45.679946),
        (48.358892, 45.823004),
        (48.331529, 45.713226),
        (48.418168, 45.595864),
        (48.268946, 45.747311),
        (47.854140, 45.722810),
        (47.865862, 45.474173),
        (47.754947, 45.686812),
        (47.748032, 45.494700),
        (47.660062, 45.645979),
        (47.587965, 45.472854),
        (45.359717, 45.689430),  # Исправлена опечатка lat/lon
        (46.893050, 45.574722),
        (47.174993, 46.105559),
        (46.833609, 46.072768),
        (46.866658, 46.248052),
        (46.478331, 46.275556),
        (46.660277, 46.428045),
        (46.961942, 46.428600),
        (46.913320, 46.555264),
        (47.227773, 46.740825),
        (46.796392, 46.996387),
        (46.515554, 47.391932),
        (46.830549, 47.576098),
        (46.680822, 47.632486),
        (46.331389, 47.431110),
        (46.141936, 47.489986),
        (45.736113, 47.836374),
        (45.718879, 48.033884),
        (45.546104, 47.993610),
        (44.997780, 48.292773),
        (45.000000, 48.295681),
    ]),
    "Волгоградская область": Polygon([
        (45.000000, 59.115959),
        (43.750198, 59.260970),
        (43.526100, 59.169441),
        (43.488328, 59.301658),
        (43.338204, 59.207595),
        (42.810549, 59.164992),
        (42.612216, 59.318603),
        (42.276104, 59.261665),
        (42.049169, 59.428603),
        (41.957219, 59.283333),
        (42.094159, 59.236938),
        (42.033057, 59.120544),
        (41.166946, 58.965271),
        (41.247778, 58.876939),
        (41.224997, 58.724992),
        (40.926238, 58.579248),
        (40.179726, 58.548051),
        (39.610283, 58.902771),
        (39.101396, 58.957213),
        (38.932504, 58.938880),
        (38.921389, 58.738883),
        (38.046955, 58.735825),
        (37.626430, 58.490357),
        (37.091672, 58.870270),
        (36.785008, 58.818055),
        (36.501401, 58.531664),
        (36.224171, 58.510829),
        (36.119726, 58.704439),
        (35.716948, 58.837771),
        (35.266310, 58.763049),
        (35.119575, 58.813304),
        (35.179008, 58.933849),
        (34.884454, 59.055269),
        (34.729897, 59.103365),
        (34.911950, 59.254441),
        (35.391381, 59.302483),
        (35.458610, 59.425544),
        (35.283631, 59.493879),
        (35.493340, 59.484716),
        (35.494729, 59.650266),
        (35.641121, 59.653599),
        (35.405006, 59.712207),
        (35.414741, 59.976015),
        (35.084733, 60.017206),
        (35.266679, 60.593041),
        (35.142786, 60.778869),
        (35.474726, 60.871367),
        (35.719072, 61.217993),
        (36.642785, 61.554700),
        (37.773063, 61.522207),
        (37.964172, 61.142485),
        (38.188057, 61.122756),
        (38.215285, 60.919433),
        (38.381673, 60.958319),
        (38.642506, 60.707762),
        (39.186634, 60.653457),
        (39.645557, 60.749709),
        (39.967501, 60.647765),
        (40.425837, 60.787764),
        (40.743891, 60.784712),
        (41.353892, 60.645820),
        (41.378335, 60.852210),
        (41.921112, 60.919707),
        (42.405830, 60.767761),
        (42.641113, 60.866653),
        (42.989723, 60.734429),
        (43.521109, 60.765542),
        (43.774167, 61.021927),
        (44.070553, 61.082206),
        (44.172772, 61.082488),
        (44.153608, 60.969428),
        (45.229161, 60.903868),
        (45.340832, 61.207761),
        (45.795941, 61.167501),
        (45.759442, 61.024152),
        (46.057499, 60.984983),
        (46.520831, 61.063870),
        (47.085268, 60.824705),
        (46.952776, 60.655257),
        (47.061662, 60.576652),
        (46.856660, 60.515267),
        (46.744996, 60.256380),
        (46.294999, 60.242488),
        (46.606102, 60.065265),
        (47.036942, 60.118320),
        (46.923050, 59.784436),
        (47.123046, 59.761380),
        (47.113517, 59.611380),
        (46.405265, 59.632489),
        (46.355552, 59.342489),
        (46.031379, 59.309714),
        (45.949157, 59.181664),
        (45.018883, 59.115548),
        (45.000000, 59.115959),
    ]),
    "Ростовская область": Polygon([
        (40.151634, 49.612617),
        (40.900542, 49.693877),
        (41.350828, 50.083327),
        (41.362203, 50.226286),
        (41.613605, 49.963607),
        (42.139713, 49.731934),
        (42.064435, 49.153878),
        (42.344433, 49.152490),
        (42.747211, 48.795275),
        (42.630543, 48.546946),
        (42.072492, 48.408885),
        (42.151928, 48.282215),
        (42.044994, 48.259167),
        (42.019154, 48.035001),
        (42.486653, 48.016394),
        (42.939710, 47.513618),
        (43.224988, 47.449722),
        (43.731770, 47.476562),
        (43.801655, 47.282212),
        (43.941929, 47.267220),
        (44.244152, 47.581948),
        (44.334980, 47.456949),
        (44.265828, 46.906947),
        (43.812200, 46.584727),
        (43.971921, 46.342220),
        (43.864156, 46.289174),
        (43.771657, 46.409435),
        (43.619153, 46.186115),
        (43.361380, 46.170842),
        (42.933867, 46.438611),
        (42.718444, 46.369073),
        (42.035270, 46.555562),
        (42.210539, 46.314450),
        (41.963050, 46.302228),
        (41.651931, 46.176671),
        (41.679435, 45.978880),
        (41.162560, 45.953490),
        (40.948044, 46.196104),
        (40.995537, 46.299177),
        (40.756387, 46.231672),
        (40.231103, 46.348890),
        (40.213052, 46.530553),
        (40.041383, 46.550832),
        (40.135819, 46.723050),
        (40.053117, 46.772083),
        (39.433870, 46.807781),
        (39.232761, 46.770557),
        (39.174168, 46.618328),
        (38.856663, 46.590000),
        (38.911380, 46.821949),
        (38.673988, 46.871058),
        (39.300474, 47.019926),
        (39.201392, 47.284676),
        (38.234363, 47.115369),
        (38.224418, 47.313118),
        (38.310752, 47.561675),
        (38.764781, 47.684145),
        (38.834754, 47.862062),
        (39.782614, 47.872228),
        (40.018057, 48.251088),
        (39.850306, 48.322087),
        (39.946031, 48.370059),
        (39.850057, 48.570808),
        (39.666558, 48.619059),
        (39.800362, 48.837777),
        (40.070888, 48.867001),
        (39.669166, 49.044640),
        (39.931693, 49.052860),
        (40.199636, 49.243111),
        (40.067359, 49.499668),
        (40.162028, 49.596169),
        (40.151634, 49.612617),
    ]),
}

# 2) Идентификаторы регионов из БД
REGION_ID_MAP = {
    "Республика Адыгея": 1,
    "Республика Калмыкия": 2,
    "Краснодарский край": 3,
    "Астраханская область": 4,
    "Волгоградская область": 5,
    "Ростовская область": 6,
}